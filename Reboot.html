<!DOCTYPE html>
<html>

<head>
    <meta property="article:published_time" content="2023-03-20T17:21:19.000Z" />
</head>

<body>
    <main>
        <article>
            <section>
                <div class="pw-post-title">
                    <h1>The benefits of a reboot</h1>
                </div>
                <p class="pw-post-body-paragraph">
                    A good, but very long text 
                    <a href="https://keunwoo.com/notes/rebooting/">https://keunwoo.com/notes/rebooting/</a> that contains two simple ideas:                
                </p> 
                <p class="pw-post-body-paragraph">
                <ol>
                <li>Entropy accumulates in any system. In other words, there is heisenbug in the system
                    <a href="https://ru.wikipedia.org/wiki/Heisenbug">https://ru.wikipedia.org/wiki/Heisenbug</a>.</li>
                <li>Rebooting (VM, host, program) is a simple way to return the system from a state with accumulated error to a state without such error.</li>
                </ol>                
                </p>
                <p class="pw-post-body-paragraph">
                    People who know me better know that I like to give a couple of strange architectural tips:
                </p>                
                <p class="pw-post-body-paragraph">             
                <ul>
                <li>Periodically restart your programs on the cluster. Usually, updating versions is enough if it is regular.</li>
                <li>A slightly stranger tip - insert abort() into your program in random places. In prod, specifically in prod.</li>               
                </ul>
                </p>                              
                <p class="pw-post-body-paragraph">
                    Before reading the following example from my practice, try to imagine why this is good and right, and what problems it will protect you from.
                </p>
                <p class="pw-post-body-paragraph">
                    My unbound hung. Well, it hung and hung, somewhere in select/poll/etc, did not respond to requests and did nothing itself.                
                </p>
                <p class="pw-post-body-paragraph">
                    Of course, you can tilt at windmills, send a completely meaningless stack trace (because without symbols) in the upstream, and wait for the sun to shine.                
                </p>
                <p class="pw-post-body-paragraph">
                    I did exactly what I suggested above - started regularly reducing the entropy of the system by regularly restarting unbound - 
                    <a href="https://github.com/pg83/ix/blob/main/pkgs/bin/unbound/runit/ix.sh#L8">https://github.com/pg83/ix/blob/main/pkgs/bin/unbound/runit/ix.sh#L8</a>, 
                    with using `/bin/timeout 300`                
                </p>
                <p class="pw-post-body-paragraph">
                    Once every 5 minutes is quite enough for the DNS cache to be useful.                
                </p>            
            </section>
        </article>
    </main>
</body>

</html>
