
<!DOCTYPE html>
<html>

<head>
    <meta property="article:published_time" content="2022-05-28T19:39:49.000Z" />
</head>

<body>
    <main>
        <article>
            <section>
                <div class="pw-post-title">
                    <h1>Why stal/IX. Part 2</h1>
                </div>
                <p class="pw-post-body-paragraph">
                    Prereq: Part 1
                </p>
                <p class="pw-post-body-paragraph">
                    Many times I promised to write about why I created my own Linux distribution and why it is designed this way.
                </p>
                <p class="pw-post-body-paragraph">
                   Part two: Why this way and not another
                </p>
                <p class="pw-post-body-paragraph">
                    Directory structure
                </p>
                <p class="pw-post-body-paragraph">
                    Here everything is pretty simple. I don’t understand how one can create a new distribution based on
                    <a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">LSB/FHS</a> nowadays.                
                </p>
                <p class="pw-post-body-paragraph">
                    This is some kind of creepy legacy that has remained since the beginning of Unix, with a bunch of poorly solvable problems 
                    (DLL hell, atomic updates (ostree is a hack, don't argue otherwise)).                
                </p>
                <p class="pw-post-body-paragraph">
                    The FS should be a content addressable storage, similar to Git/Nix/Guix.                
                </p>
                <p class="pw-post-body-paragraph">
                    This provides us with almost free benefits, just to name a few:                
                </p>
                <ul>
                <li>Multi-versioning.</li>
                <li>Fast rollbacks and updates.</li>
                <li>Atomic updates (switching the entire configuration - switching 1 symlink).</li>
                <li>Free caching of build artifacts in the package system.</li>
                <li>Non-root/user package management. This is a direct consequence of content addressable storage.</li>
                </ul>
                <p class="pw-post-body-paragraph">
                    Functional configuration management
                </p>
                <p class="pw-post-body-paragraph">
                    This refers to the fact that the contents of etc/ are actually determined by a set of realm settings and a description of the package base.<br>
                    You can’t manually edit etc/, it is generated by realm preparation scripts and is read-only.
                </p>
                <p class="pw-post-body-paragraph">
                    I won’t write much here, those who know will understand, and I won’t be able to explain it in two sentences anyway.
                </p>
                <p class="pw-post-body-paragraph">
                    Static linking
                </p>
                <p class="pw-post-body-paragraph">
                    A good text with a summary of why the main criticisms of static linking cannot withstand serious scrutiny - 
                    <a href="https://lore.kernel.org/lkml/CAHk-=whs8QZf3YnifdLv57+FhBi5_WeNTG1B-suOES=RcUSmQg@mail.gmail.com/">https://lore.kernel.org/lkml/CAHk-=whs8QZf3YnifdLv57+FhBi5_WeNTG1B-suOES=RcUSmQg@mail.gmail.com/</a>.
                </p>
                <p class="pw-post-body-paragraph">
                    Some arguments from Linus - 
                    <a href="https://gavinhoward.com/2021/10/static-linking-considered-harmful-considered-harmful/">https://gavinhoward.com/2021/10/static-linking-considered-harmful-considered-harmful/</a>.
                </p>
                <p class="pw-post-body-paragraph">
                    My arguments for static linking:
                </p>
                <ul>
                <li>The tooling for static linking is still better because it's as simple as ABC.</li>
                <li>According to forums, Linux has an eternal problem with dynamically loaded plugins - something may not be found at runtime, 
                    and because of this, nothing works. If it's linked statically, then the declared functionality will be available.</li>
                <li>The resulting binaries are faster despite some duplication of object code.</li>
                <li>The file system is cleaner, there is no unnecessary garbage, and I can tell what each file does. 
                    In Nix/Guix, for example, there can be dozens of versions of the same library, it's ungrepable noodles.</li>
                <li>As a consequence, it is aesthetically easier to have different versions of the same library because they do not hurt the eyes.</li>
                <li>Personal factor. For the last 15 years, I have been promoting static linking at Yandex and have generally succeeded in doing so. 
                    I have the ambition to show the world that based on this model, it is possible to create a full-fledged, non-toy distribution.</li>
                </ul>                
                <p class="pw-post-body-paragraph">
                    Healthy minimalism
                </p>
                <p class="pw-post-body-paragraph">
                    I want to be able to oversee the entire system. No code bloat, no systemd, no PipeWire(?), etc.<br>
                    Overall, no vendor lock on RedHat/IBM software.                
                </p>
                <p class="pw-post-body-paragraph">
                    The Red Hats really want to lock the Linux ecosystem onto themselves. Onto systemd, onto GStreamer as a part of PipeWire, etc.<br>
                    I don’t see anything good in this, and all this software hinders the ability to understand how the system works.
                </p>
                <p class="pw-post-body-paragraph">
                    I’ll just briefly note here that I don’t mind if someone makes a variant stal/IX on top of systemd, 
                    I'm not getting in the way of that, and I'm even willing to help.
                </p>
                <p class="pw-post-body-paragraph">
                    Take a look at this
                    <a href="https://git.sr.ht/~pg/ix/tree/main/item/pkgs/bin/dbus">folder</a>, even my runit scripts are not part of the main package 
                    so that you can have systemd/s6/etc units in parallel.                
                </p>
                
          </section>
        </article>
    </main>
</body>

</html>
